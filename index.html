<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TrustSeal VeChain Notary</title>
  <style>
    :root {
      --bg-primary: #121212;
      --bg-secondary: #1e1e1e;
      --bg-tertiary: #2d2d2d;
      --text-primary: #e0e0e0;
      --text-secondary: #a0a0a0;
      --accent: #4a86e8;
      --success: #4caf50;
      --warning: #ff9800;
      --error: #f44336;
      --border-radius: 8px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

    body { 
      background: var(--bg-primary); 
      color: var(--text-primary); 
      min-height: 100vh; 
      padding: 20px; 
    }

    .container { 
      max-width: 800px; 
      margin: 0 auto; 
      background: var(--bg-secondary); 
      padding: 30px; 
      border-radius: var(--border-radius); 
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    }

    h1 { 
      text-align: center; 
      margin-bottom: 30px; 
      background: linear-gradient(90deg, var(--accent), #9c27b0);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .info-banner {
      background: var(--bg-tertiary);
      padding: 20px;
      border-radius: var(--border-radius);
      margin-bottom: 25px;
      text-align: center;
      border-left: 4px solid var(--success);
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    input, select, textarea {
      width: 100%;
      padding: 12px;
      background: var(--bg-tertiary);
      border: 1px solid #444;
      border-radius: var(--border-radius);
      color: var(--text-primary);
      font-size: 16px;
    }

    .btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 14px;
      border-radius: var(--border-radius);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
      width: 100%;
      margin: 10px 0;
    }

    .btn:hover { background: #5b94f0; }
    .btn:disabled { background: #666; cursor: not-allowed; }
    .btn-success { background: var(--success); }
    .btn-success:hover { background: #66bb6a; }

    .status {
      margin-top: 20px;
      padding: 15px;
      background: var(--bg-tertiary);
      border-radius: var(--border-radius);
      min-height: 100px;
      max-height: 300px;
      overflow-y: auto;
    }

    .status-message {
      margin: 10px 0;
      padding: 8px;
      border-radius: 4px;
    }

    .success { background: rgba(76, 175, 80, 0.2); color: var(--success); }
    .error { background: rgba(244, 67, 54, 0.2); color: var(--error); }
    .info { background: rgba(33, 150, 243, 0.2); color: var(--accent); }
    .warning { background: rgba(255, 152, 0, 0.2); color: var(--warning); }

    .hash-display {
      background: var(--bg-tertiary);
      padding: 10px;
      border-radius: var(--border-radius);
      font-family: monospace;
      word-break: break-all;
      margin: 10px 0;
      font-size: 14px;
    }

    .verification-links {
      margin: 20px 0;
      text-align: center;
    }

    .verify-btn {
      background: var(--success);
      margin: 5px;
      display: inline-block;
    }

    .verify-btn:hover {
      background: #66bb6a;
    }

    footer {
      text-align: center;
      padding: 30px 0 20px;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üåê TrustSeal VeChain Notary</h1>
    <p style="text-align: center; margin-bottom: 30px; color: var(--text-secondary);">
      No wallet required - We pay all gas fees!
    </p>
    
    <div class="info-banner">
      <h3>üõ°Ô∏è Secure Document Notarization</h3>
      <p style="margin: 15px 0; color: var(--text-secondary);">
        Your documents are processed securely<br>
        <strong>All blockchain fees covered by us</strong><br>
        Zero cryptocurrency wallet needed
      </p>
    </div>
    
    <div class="form-group">
      <label for="fileInput">üìé Select Document</label>
      <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.png,.jpg,.jpeg,.txt,.html,.js,.css">
      <div id="fileName" style="margin-top: 8px; color: var(--text-secondary); font-size: 14px;">
        No file selected
      </div>
    </div>
    
    <div class="form-group">
      <label for="serviceType">„Çµ„Éº„Éì„Çπ„Çø„Ç§„Éó</label>
      <select id="serviceType">
        <option value="Creative Proof">Creative Proof</option>
        <option value="Car Accident">Car Accident</option>
        <option value="Rental Contract">Rental Contract</option>
        <option value="Personal Loan">Personal Loan</option>
        <option value="Logistics POD">Logistics POD</option>
        <option value="Other">Other</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="email">üìß Your Email</label>
      <input type="email" id="email" placeholder="For notifications and verification">
    </div>
    
    <button class="btn" id="notarizeBtn">
      üîê Notarize Document (We Pay Gas Fees)
    </button>
    
    <div class="status" id="status">
      <div class="status-message info">Select a document and click "Notarize Document"</div>
    </div>
  </div>

  <footer>
    <p>TrustSeal VeChain Notary - Completely wallet-free</p>
    <p>We handle all blockchain fees - you just upload your documents</p>
  </footer>

  <script>
    // DOM Elements
    const fileInput = document.getElementById('fileInput');
    const fileName = document.getElementById('fileName');
    const serviceType = document.getElementById('serviceType');
    const email = document.getElementById('email');
    const notarizeBtn = document.getElementById('notarizeBtn');
    const status = document.getElementById('status');
    
    // State
    let currentFile = null;
    
    // Event Listeners
    fileInput.addEventListener('change', function() {
      currentFile = this.files[0];
      fileName.textContent = currentFile ? currentFile.name : 'No file selected';
    });
    
    // Show status message
    function showStatus(message, type = 'info') {
      const messageDiv = document.createElement('div');
      messageDiv.className = `status-message ${type}`;
      messageDiv.textContent = message;
      status.appendChild(messageDiv);
      status.scrollTop = status.scrollHeight;
    }
    
    function clearStatus() {
      status.innerHTML = '';
    }
    
    // Hash file using SHA-256
    async function hashFile(file) {
      const buffer = await file.arrayBuffer();
      const hashBuffer = await crypto.subtle.digest('SHA-256', buffer);
      return Array.from(new Uint8Array(hashBuffer))
        .map(b => b.toString(16).padStart(2, '0'))
        .join('');
    }
    
    // Notarize document (calls your backend with your credentials)
    async function notarizeDocument() {
      // Validation
      if (!currentFile) {
        showStatus('Please select a document first!', 'error');
        return;
      }
      
      const emailValue = email.value.trim();
      if (!emailValue || !emailValue.includes('@')) {
        showStatus('Please enter a valid email address!', 'error');
        return;
      }
      
      // Disable button during processing
      notarizeBtn.disabled = true;
      notarizeBtn.textContent = 'üîÑ Processing Document...';
      
      clearStatus();
      showStatus(`üìÑ Processing: ${currentFile.name}`, 'info');
      showStatus(`‚öñÔ∏è Size: ${(currentFile.size/1024).toFixed(2)} KB`, 'info');
      showStatus('üîë Generating SHA-256 hash...', 'info');
      
      try {
        // Generate file hash
        const fileHash = await hashFile(currentFile);
        showStatus(`‚úÖ Hash Generated: ${fileHash.substring(0, 32)}...`, 'success');
        
        // Show full hash
        const hashDisplay = document.createElement('div');
        hashDisplay.className = 'hash-display';
        hashDisplay.innerHTML = `<strong>üÜî Document Hash:</strong><br>${fileHash}`;
        status.appendChild(hashDisplay);
        
        showStatus('üåê Submitting to VeChain blockchain...', 'info');
        showStatus('üí≥ Processing payment (we cover all gas fees)...', 'info');
        
        // Call your backend API with your testnet credentials
        const formData = new FormData();
        formData.append('file', currentFile);
        formData.append('hash', fileHash);
        formData.append('email', emailValue);
        formData.append('serviceType', serviceType.value);
        formData.append('fileName', currentFile.name);
        formData.append('fileSize', currentFile.size);
        formData.append('timestamp', new Date().toISOString());
        
        // IMPORTANT: Replace with your actual backend URL
        const BACKEND_URL = 'https://your-backend-domain.com/api/notarize';
        
        const response = await fetch(BACKEND_URL, {
          method: 'POST',
          body: formData
        });
        
        if (!response.ok) {
          throw new Error(`Backend error: ${response.status} ${response.statusText}`);
        }
        
        const result = await response.json();
        
        if (result.success) {
          showStatus('üéâ Document Successfully Notarized!', 'success');
          showStatus(`üÜî Transaction ID: ${result.txId.substring(0, 32)}...`, 'success');
          showStatus(`üïí Timestamp: ${new Date(result.timestamp).toLocaleString()}`, 'info');
          showStatus(`‚õΩ Gas Used: ${result.gasUsed} VTHO (covered by us)`, 'info');
          showStatus(`üì¶ Block Number: ${result.blockNumber}`, 'info');
          
          // Show verification links
          const verificationDiv = document.createElement('div');
          verificationDiv.className = 'verification-links';
          verificationDiv.innerHTML = `
            <div class="hash-display">
              <strong>üîó Verification Hash:</strong><br>
              ${result.fileHash}
            </div>
            <button class="verify-btn" onclick="window.open('https://testnet.vechain.org/transactions/${result.txId}', '_blank')">
              üåê VeChain Testnet Explorer
            </button>
            <button class="verify-btn" onclick="copyHash('${result.fileHash}')">
              üìã Copy Hash
            </button>
          `;
          status.appendChild(verificationDiv);
          
        } else {
          throw new Error(result.error || 'Unknown error from backend');
        }
        
      } catch (error) {
        console.error('Notarization error:', error);
        showStatus(`‚ùå Error: ${error.message}`, 'error');
        showStatus('üí° Please try again or contact support', 'warning');
      } finally {
        // Re-enable button
        notarizeBtn.disabled = false;
        notarizeBtn.textContent = 'üîê Notarize Document (We Pay Gas Fees)';
      }
    }
    
    // Copy hash to clipboard
    function copyHash(hash) {
      navigator.clipboard.writeText(hash).then(() => {
        showStatus('üìã Hash copied to clipboard!', 'success');
      }).catch(() => {
        showStatus('‚ùå Failed to copy hash', 'error');
      });
    }
    
    // Event listener for notarize button
    notarizeBtn.addEventListener('click', notarizeDocument);
    
    // Initialize
    showStatus('Ready to notarize your document on VeChain', 'info');
    showStatus('üõ°Ô∏è Files are processed locally - never leave your browser', 'warning');
  </script>
</body>
</html>
